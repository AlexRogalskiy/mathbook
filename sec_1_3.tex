\section{Язык логики предикатов}
\label{sec:Pred}\enlargethispage{\baselineskip}
\p Рассматривая формулы алгебры исчисления высказываний, мы~отвлеклись от~природы входящих в~них переменных, которые интересовали нас лишь в~аспекте истинностного значения. Тот факт, что пропозициональные переменные представляют собой высказывания, до~сих пор никак не~использовался. Теперь мы~продвинемся глубже и~рассмотрим высказывание само по~себе.

Из школьного курса грамматики известно, что обычным образом построенное предложение имеет подлежащее и~сказуемое, или, если пользоваться латинскими терминами, субъект и~предикат. К~примеру, в~предложении <<Сократ~--- человек>> слово <<Сократ>> является субъектом, а~<<человек>>~--- предикатом. Мы~будем понимать термины <<субъект>> и~<<предикат>> несколько шире, чем лингвисты: всё то, \emph{о чём} говорится в~высказывании, мы~назовём субъектами, а~всё то, \emph{что} говорится~--- предикатом.

Таким образом, для нас часть высказывания, выражаемая шаблоном <<$x$~--- человек>>, будет представлять собой предикат, из~которого получится истинное высказывание, если в~качестве субъекта (вместо переменной~$x$) подставить <<Сократ>>, и~ложное, если субъект~--- <<Хирон>> (кентавр). Можно рассмотреть предикат <<$x$~в~нормальных условиях кипит при 100 \textdegree C>>, дающий истинное высказывание, если субъект~--- <<вода>>, и~ложное, если субъект~--- <<олово>>. Таким образом, мы~приходим к~пониманию предиката как \emph{функции}, принимающей значения~$\true$ и~$\false$ в~зависимости от~подставляемых в~неё аргументов. Мы~рассматривали предикаты только одного аргумента (одноместные), вот пример двухместного предиката: <<$x$~муж~$y$>>, дающий истинное высказывание, если в~качестве первого и~второго субъектов выступают соответственно <<Сократ>> и~<<Ксантиппа>>, и~ложное, скажем, в~случае субъектов <<Вронский>> и~<<Анна Каренина>>. Пример трёхместного предиката: <<$x + y = z$>>, дающий~$\true$ для набора субъектов <<2, 2, 4>> и~$\false$ для <<1, 1, 1>>. Наконец, можно рассмотреть и~нуль-местные предикаты: предикаты, не~требующие субъектов; различных между собой нуль-местных предикатов всего два: $\true$ и~$\false$.

Подведём итог. Пусть дано непустое множество~$M$, которое назовём \emph{предметной областью}. \emph{$n$-местным предикатом} на~множестве~$M$ называется функция, ставящая в~соответствие каждому упорядоченному набору~$n$ элементов множества~$M$ одно из~значений~$\true$ или~$\false$. Предикаты, таким образом, принимают те~же~значения, что и~булевы функции, но~коренное отличие в~том, что предикат может быть определён на~произвольном множестве.

На данном этапе мы~можем воспринимать \emph{множества} и~\emph{функции} как некие умозрительные объекты: множество~--- как совокупность объектов, рассматриваемую как единое целое, и~функцию~--- как некоторый закон, согласно которому каждому объекту-аргументу (или набору объектов-аргументов) поставлен в~соответствие один единственный результат. Разумеется, это нельзя считать определением понятий <<множество>> и~<<функция>>, более формальный разговор о~которых пойдёт в~гл.~\ref{chapter:sets}. Но~там потребуется определённый навык вывода в~\emph{исчислении предикатов}, приобрести который на~практике, по-видимому, невозможно без начальных рассуждений о~предметных областях, моделях и~оценках, так или иначе задействующих термин <<множество>>.

Для обозначения предикатов в~формулах будет использоваться набор символов (как правило, заглавных латинских букв~$P$, $Q$,~$R$\ldots, возможно, с~индексами), называемых \emph{предикатными символами}. Для обозначения элементов предметной области в~формулах будет использоваться набор строчных латинских букв, возможно, с~индексами, называемых \emph{термами}. Понятие \emph{терм} в~общем случае означает некоторое выражение, указывающее на объект (в~отличие от \emph{формулы}, которая имеет характер высказывания об~одном или нескольких объектах).

\p \emph{Сигнатурой} $\sigma$ называется произвольный набор термов~$\vect cl$ (\emph{предметных констант}), а также предикатных символов~$\vect Pk$, обладающих целыми неотрицательными \emph{валентностями} $\vect nk$\footnote{\,Для упрощения изложения намеренно игнорируются <<функциональные символы>>, традиционно входящие в~определение сигнатуры, т.~к. для построения аксиоматической теории множеств и~аппарата родов структур без функциональных символов можно обойтись.}. Определим, какие цепочки символов являются \emph{формулами} (или \emph{соотношениями}) \emph{сигнатуры}, пока что не~рассматривая их~смысл:\label{praedformula}\sloppy
\begin{enumerate}
	\item Константы сигнатуры~$\vect cl$ и~буквы~$\vect xn$, называемые \emph{индивидными переменными}, являются \emph{термами} сигнатуры. Предполагается, что, глядя на~выражение, всегда можно различить, где малая латинская буква в нём обозначает константу, а~где~--- переменную.
	\item Если~$P$~--- предикатный символ валентности~$n$ сигнатуры, а~$\vect tn$~--- термы, то~цепочка символов \[P(\vect tn)\] называется \emph{атомарной формулой сигнатуры}. Кроме того, любой предикатный символ нулевой валентности есть атомарная формула сигнатуры. Атомарная формула сигнатуры есть формула сигнатуры.
	\item Если~$A$~--- формула сигнатуры, то~$\neg A$~--- формула сигнатуры.
	\item Если~$A$ и~$B$~--- формулы, а~$\gamma$~--- какая-либо из~логических связок~$\vee$, $\&$, $\imp$, то~$(A\mathbin\gamma B)$~--- формула сигнатуры.
	\item Если~$A$~--- формулы сигнатуры, $x$~--- индивидная переменная, а~$\mathsf Q$~--- какой-либо из~кванторов~$\forall$, $\exists$, то~$\mathsf Q x A$~--- формула сигнатуры.
	\item Других формул не~существует.
\end{enumerate}

К примеру, если~$\sigma$ содержит предикатные символы~$P$, $Q$ и~$R$ валентностей~2, 1 и~2 соответственно, то~цепочка символов\pagebreak[2] \[\neg \forall x (P(x, y) \& \exists z (Q(z) \vee R(z, y)))\] является корректной формулой~$\sigma$.

\begin{exercise}Найдите все подформулы указанной формулы.
\end{exercise}

Легко видеть (ср. определение пропозициональной формулы на~с.~\pageref{logopformula}), что из~любой пропозициональной формулы можно построить формулу сигнатуры, если вместо пропозициональных переменных подставить формулы сигнатуры. Применяя соглашения о~приоритете логических операций, введённые на~с.~\pageref{logoppriority}, в~формулах сигнатур мы~также будем опускать избыточные скобки, когда это не~ведёт к~разночтениям. Примем, кроме того, соглашение, по~которому при отсутствии группирующих скобок квантор действует только на~первую следующую за~ним подформулу, т.~е. выражение $\exists x P(x) \& Q(y)$ интерпретируется как $(\exists x P(x)) \& Q(y)$.

\begin{exercise}\cite{Lavrov04}. Покажите, что выражение $\exists n \forall x_1 \ldots \forall x_{n} (P(x_1) \& \ldots \& P(x_{n}))$, где~$P$~--- одноместный предикат, не~является формулой. Указание: является ли~$n$ индивидной переменной?
\end{exercise}

\p Теперь мы~можем определить, что такое \emph{модель~$\mathfrak M$} сигнатуры~$\sigma$, \emph{оценка~$\pi$} в~модели~$\mathfrak M$ и~\emph{истинностное значение} формулы~$A$ сигнатуры~$\sigma$ на~оценке~$\pi$.

\emph{Моделью}~$\mathfrak M$ сигнатуры~$\sigma$ называются: непустое множество~$M$ (предметная область), набор элементов этого множества, соответствующих предметным константам~$\vect cl$, и~такой набор определённых на~данном множестве предикатов, что каждому предикатному символу валентности~$n$ из~$\sigma$ соответствует один и~только один~$n$-местный предикат из~$\mathfrak M$. Ясно, что сигнатура может иметь много моделей. Например, если в~сигнатуре содержится один предикатный символ~$P$ валентности~3, то~её моделями могут быть, например, такие: $M$~--- множество натуральных чисел, предикат для символа~$P$ есть <<$x + y = z$>>; $M$~--- множество точек плоскости, предикат для символа~$P$ есть <<точки~$x$, $y$ и~$z$ лежат на~одной прямой>>.

\emph{Оценкой}~$\pi$ в~модели~$\mathfrak M$ называется набор элементов множества~$M$, поставленный в~соответствие индивидным переменным таким образом, что каждой индивидной переменной соответствует один и~только один элемент множества~$M$. Другими словами, задавая оценку, мы~указываем, каким именно элементам~$M$ соответствуют переменные, участвующие в~рассматриваемых нами формулах. Для того чтобы сослаться на~элемент~$M$, обозначаемый буквой~$x$ на~оценке~$\pi$, будем пользоваться, как в~книге~\cite{VereShen2}, обозначением~$[x]\pi$. (Естественно, константы будут обозначать один и~тот же~элемент на~любой оценке~--- их~значения задаются уже моделью.)

Наконец, \emph{истинностное значение} формулы~$A$ сигнатуры~$\sigma$ на~оценке~$\pi$, равное~$\true$ или~$\false$ и~обозначаемое~$[A]\pi$, определяется следующим образом:
\begin{enumerate}
	\item Истинностное значение атомарной формулы $P(\vect xn)$ есть результат подстановки в~предикат, соответствующий символу~$P$, элементов $[x_1]\pi, \ldots [x_n]\pi$, т.~е. $[P(\vect xn)]\pi = P([x_1]\pi, \ldots [x_n]\pi)$.\sloppy
	\item $[\neg A]\pi = \neg ([A]\pi)$.
	\item $[A\mathbin\gamma B]\pi = [A]\pi \mathbin\gamma [B]\pi$ (пп. 2 и~3, по-видимому, в~комментариях не~нуждаются).
	\item Формула $\exists x A$ (которая читается <<существует такой~$x$, что~$A$>>) является истинной тогда и~только тогда, когда существует хотя бы~одна оценка~$\pi'$, отличающаяся от~$\pi$ \emph{только} значением переменной~$x$, такая, что ${[A]\pi' = \true}$.
	
Когда предметная область~$M$ состоит из~конечного числа элементов~$\vect mN$, формула $\exists x A$ сводится к~обычной дизъюнкции по~всем элементам~$M$: $[\exists x A]\pi = [A](\pi + x \mapsto m_1) \vee \ldots \vee [A](\pi + x \mapsto m_N) = \bigvee \limits_{i = 1}^N [A](\pi + x \mapsto m_i)$.

		Здесь $\pi + x \mapsto m_i$ обозначает, как в~книге~\cite{VereShen2}, оценку, отличающуюся от~$\pi$ только значением переменной~$x$, такую, что $[x](\pi + x \mapsto m_i) = m_i$. Для случая, когда~$M$ состоит из~произвольного (возможно, бесконечного) количества элементов, нам потребуется <<всеобщая дизъюнкция>>:
	\[[\exists x A]\pi = \bigvee_{m \in M} [A](\pi + x \mapsto m).\]
	\item Аналогично, истинность формулы $\forall x A$ (<<для всех~$x$ имеет место~$A$) определяется как
	\[[\forall x A]\pi = \mathop {\hbox{\huge \char'046}}\limits_{m \in M} [A](\pi + x \mapsto m).\]
	
\end{enumerate}

Когда даны модель и оценка, истинностное значение имеет каждая формула сигнатуры. Здесь ситуация несколько сложнее, чем в~алгебре высказываний, где достаточно было задать истинностные значения пропозициональных переменных.


\p Заметим, что по~определению истинности истинностные значения формул $\exists x A$, $\forall x A$ \emph{не зависят} от~индивидной переменной~$x$, <<пробегающей значения>> по~предметной области. Легко указать аналогию с~другими математическими формулами: к~примеру, формулы вида
\[
\sum_j {A_{ij}f_j}, \quad \intop_D K(x, y)f(y)\,dy
\]
обозначают соответственно вектор, индексируемый переменной~$i$, и~функцию, зависящую от~$x$, не~зависимые~$j$ и~$y$ соответственно. В~приведённых примерах переменные~$j$ и~$y$ являются \emph{связанными}, а~$i$ и~$x$~--- \emph{свободными}. Одна и~та~же~буква может входить в~формулу и~в~качестве свободной, и~в~качестве связанной переменной. В~формуле \[\intop_0^1 x^2y\,dx + 3x\] $y$ свободна, а~для~$x$ ситуация сложнее: первые два её вхождения связаны, а~третье~--- свободно. Аналогичную ситуацию имеем в~формуле $\exists x Q(x, y) \vee P(x) $, где два первых вхождения~$x$ <<подпадают под действие>> квантора~$\exists$, а~последнее~--- <<не подпадает>>.

\begin{exercise}\cite{Lavrov04}. Определите свободные и~связанные вхождения переменных в~формулах
\[
\begin{array}{l}
\forall x (P (x, y) \imp \forall y Q(x, y)),\\
\forall x P (x, y) \imp \forall y R(x, y),\\
\neg \exists y Q(y,y) \& R(y, y).
\end{array}
\]
\end{exercise}

Рассмотрим формулу $\int_0^1 x^2y\, dx + 3x$. Функция двух переменных~$x$ и~$y$, выражаемая этой формулой, не~изменится, если все связанные вхождения переменной~$x$ заменить, например, буквой~$t$: $\int_0^1 t^2y\, dt + 3x$. Вместо буквы~$t$ могла бы~быть использована любая другая буква, кроме~$y$, ибо замена связанных вхождений~$x$ на~$y$ даст побочный эффект: $\int_0^1 y^2y\, dy + 3x$ вообще перестаёт быть функцией двух переменных. В~последнем случае произошла \emph{коллизия переменных}, причина которой в~том, что переменная~$y$ входит в~качестве свободной в~формулу под интегралом.

Аналогичная ситуация имеет место в~формулах сигнатуры. Как мы~увидим далее, в~формулах сигнатуры возможны при определённых условиях переименования связанных переменных, после которых формула будет выражать тот же~самый предикат.

Для наглядной иллюстрации свободных и~связанных вхождений переменных удобно пользоваться надстрочными линиями, демонстрирующими, какой квантор связывает какие вхождения переменных. К~примеру,

\[\begin{array}{l}
\forall\bridge{y (P(y}) \& \exists\bridge{t Q(t}, z))\imp \exists \bridge{\bridge{x R(x}, x})\vee Q(z, x),\\

\forall\bridge{\bridge{z (P(z}) \& \exists\bridge{x Q(x}, z}))\imp \exists \bridge{\bridge{x R(x}, x})\vee Q(z, x),\\

\forall\bridge{x (P(x}) \& \exists\bridge{x Q(x}, z))\imp \exists \bridge{\bridge{y R(y}, y})\vee Q(z, x).
\end{array}\]

Обратим внимание, что в~третьей формуле переменная~$x$ в~$Q(x, z)$ связывается с~ближайшим к~ней слева квантором~$\exists x$, а~не~более далёким~$\forall x$. Если теперь стереть все связанные переменные и~заменить их~пустыми <<окнами>>, получим \emph{схему} формулы, содержащую всю существенную информацию о~ней:

\[\forall\bridge{\square (P(\square}) \& \exists\bridge{\square Q(\square}, z))\imp \exists \bridge{\bridge{\square R(\square}, \square})\vee Q(z, x),\]

\[
\begin{array}{l}
\forall\bridge{\bridge{\square (P(\square}) \& \exists\bridge{\square Q(\square}, \square}))\imp \exists \bridge{\bridge{\square R(\square}, \square})\vee Q(z, x),\\
\forall\bridge{\square (P(\square}) \& \exists\bridge{\square Q(\square}, z))\imp \exists \bridge{\bridge{\square R(\square}, \square})\vee Q(z, x).
\end{array}
\]

\emph{Конгруэнтными}, или \emph{подобными}, называются формулы, схемы которых совпадают. В~приведённом примере первая и~третья формулы конгруэнтны. Кажется интуитивно очевидным, что конгруэнтные формулы <<обозначают одно и~то~же>>,~и~далее (теорема~\ref{th:cong} на~с.~\pageref{th:cong}) будет строго доказана эквивалентность конгруэнтных формул.

\begin{exercise}\cite{Kleene05}. Какие из~этих формул конгруэнтны?
\[\begin{array}{l}
\forall z \exists y (P(z, y) \& \forall z Q(z,x) \imp R(z)),\\
\forall x \exists y (P(x, y) \& \forall y Q(y,x) \imp R(x)),\\
\forall y \exists z (P(y, z) \& \forall z Q(z,x) \imp R(y)),\\
\forall z \exists x (P(z, x) \& \forall z Q(z,y) \imp R(z)),\\
\forall y \exists z (P(z, y) \& \forall z Q(z,x) \imp R(y)).\\
\end{array}\]\end{exercise}

\p Введём классификацию формул сигнатуры~$\sigma$:
\begin{itemize}
 \item Формула~$A$ называется \emph{тавтологией}, или \emph{общезначимой формулой}, и~обозначается~$\models A$, если она истинна \emph{на любой} оценке \emph{любой} модели.
 \item Формула, не~являющаяся общезначимой ($\not \models A$), называется \emph{опровержимой}. Формула опровержима тогда и~только тогда, когда можно указать хотя бы~одну модель и~оценку, на~которой эта формула ложна.
 \item Формула называется \emph{невыполнимой}, если она ложна \emph{на любой} оценке \emph{любой} модели. Ясно, что формула невыполнима тогда и~только тогда, когда её отрицание является тавтологией, т.~е. имеет место $\models \neg A$.
 \item Формула называется \emph{выполнимой}, если можно указать хотя бы~одну модель и~оценку, на~которой эта формула истинна, т.~е. имеет место $\not \models \neg A$.
\end{itemize}

Соотношение между общезначимыми, выполнимыми, опровержимыми и~невыполнимыми формулами показывает следующая диаграмма:

\[
\lefteqn{\overbrace{\phantom{\mbox{невыполнимые} \quad \mbox{общего вида}}}^{\mbox{опровержимые}}} \mbox{невыполнимые} \quad \underbrace{\mbox{общего вида} \quad \mbox{общезначимые}}_{\mbox{выполнимые}}
\]


	\begin{exercise}\cite{Lavrov04}. Докажите, что выполнимы следующие формулы (дайте модели и~оценки, на~которых они истинны):\[
\begin{array}{ll}
\exists x P(x),& \exists x \exists y (P(x) \& \neg P(y)),\\
\forall x P(x), & P(x) \imp \forall y P(y).
\end{array}
\]
\end{exercise}

%По аналогии с~исчислением высказываний, мы~будем называть формулы~$F$ и~$G$ \emph{эквивалентными} и~писать~$F \sim G$, если и~только если $\models F \lequals G$.

\p Чтобы доказать выполнимость (опровержимость) формулы логики предикатов, достаточно придумать хотя бы~одну модель и~оценку, в~которых формула истинна (ложна). Как определить, что формула логики предикатов является общезначимой (невыполнимой)? Для этого необходим новый метод рассуждения. Здесь мы~рассмотрим некоторые классы общезначимых формул, а~в~\S\,\ref{sec:predcalculus} построим \emph{исчисление предикатов}, которое будет порождать все общезначимые формулы логики предикатов и~только их.

\begin{theorem}\label{th:predtaut}
Если формула логики высказываний является пропозициональной тавтологией, то~подстановка в~неё вместо пропозициональных переменных любых формул сигнатуры будет давать общезначимую формулу логики предикатов.
\end{theorem}

\beginproof Возьмём некоторую модель и~оценку. Тогда каждая из~формул сигнатуры, подставленная в~пропозициональную тавтологию, примет значение~$\true$ или~$\false$. Однако результирующая формула примет значение~$\true$, т.~к. она даёт истину вне зависимости от~истинностных значений своих переменных. Это будет иметь место для произвольной модели и~оценки; следовательно, результирующая формула является общезначимой в~логике предикатов.\endproof

Например, формула $\exists x P(x) \vee \neg \exists x P(x)$ является общезначимой формулой логики предикатов, т.~к. получена из~пропозициональной тавтологии $A \vee \neg A$. Однако даваемый теоремой~\ref{th:predtaut} класс общезначимых формул ещё недостаточно широк: например, никакая формула вида $\mathsf \forall x A$ или $\mathsf \exists x A$ не~может попасть в~класс формул, общезначимых в~силу теоремы~\ref{th:predtaut}.

\p В~то~же~время заметим, что, например, должна быть общезначимой формула $\forall x P(x) \imp P(y)$, где~$P$~--- одновалентный предикатный символ: если в~выбранной модели~$P(x)$ истинен для каждого значения~$x$, то~он~должен быть истинным и~для произвольного значения~$y$, если же~$[\forall x P(x)]\pi = \false$, то~вся импликация будет истинной уже в~силу того, что её левая часть ложна. Можно ли~обобщить это наблюдение для произвольной формулы вместо~$P(x)$ и~произвольного терма (переменной или константы) вместо~$y$? По~традиции Бурбаки \cite{Bourbaki1}, результат текстовой замены~$x$ на~$t$ в~формуле~$A$ обозначим следующим образом: $(t \mid x) A$. Мы~стремимся доказать общезначимость чего-то вроде \[\forall x A \imp (t \mid x) A,\] где~$A$~--- произвольная формула, $x$~--- произвольная переменная, $t$~--- произвольный терм.

В общем виде это, однако, не~имеет места. Например, если формула~$A$ имеет вид $\exists x P(x) \& Q(x)$, то~результатом простой замены всех вхождений переменной~$x$ на~константу~$c$ будет синтаксически некорректная последовательность символов $\exists c P(c) \& Q(c)$ (за~квантором всегда должна следовать переменная, квантор по~константе недопустим). Таким образом, первое условие на~\emph{корректную подстановку} терма вместо переменной формулируется следующим образом: корректная подстановка $(t \mid x) A$ должна выполнять замену только \emph{свободных} вхождений переменной~$x$.

Но и~первого ограничения недостаточно, как показывает следующий пример: замена свободного вхождения~$x$ на~$y$ в~формуле $\exists y P(x, y)$ приведёт к~тому, что переменная~$x$ подпадёт под действие квантора, в~результате чего частный случай схемы $\forall x A \imp (t \mid x) A$~--- формула $\forall x \exists y P(x, y) \imp \exists y P(y, y)$~--- не~будет общезначимым.

\begin{exercise}Проверьте, что формула $\forall x \exists y P(x, y) \imp \exists y P(y, y)$ не~общезначима.\end{exercise}

Итак, необходимо ввести ещё одно ограничение и~говорить, что подстановка терма~$t$ вместо свободных вхождений переменной~$x$ в~формуле~$A$ корректна, если после этой подстановки терм~$t$ не~подпадает под действие квантора. Иными словами, эта подстановка не~должна менять схемы формулы~$A$ (за~исключением имён свободных переменных). В~дальнейшем, говоря о~подстановке $(t \mid x) A$, мы~будем иметь в~виду только корректные подстановки.

\begin{exercise}Допустим, что подстановка $(y \mid x) A$ корректна. Всегда ли~при этом будет корректна обратная подстановка $(x \mid y)(y \mid x) A$? (Ответ: нет, как, например, в~случае $\forall z P(z, x) \vee \forall x Q(x, y)$.)
\end{exercise}

Для дальнейшего нам понадобится лемма, использующая свойства, заложенные в~определение корректной подстановки.

\begin{lemma}\label{lemma:subst}
Для произвольных формулы~$A$, переменной~$x$ и~терма~$t$, если подстановка $(t \mid x)A$ корректна, имеет место \[[(t\mid x)A]\pi = [A](\pi + x \mapsto [t]\pi).\]
\end{lemma}

\beginproof Эта лемма утверждает довольно простую вещь: если, например, переменная~$x$ является единственным параметром формулы~$A$, а~$c$~--- константа, то~корректная подстановка $(c \mid x)A$ даст формулу без параметров, истинностное значение которой (в~соответствии с~леммой) должно равняться истинностному значению формулы~$A$ на~оценке, в~которой значение переменной~$x$ является элементом предметного множества, соответствующего константе~$c$.

Доказательство проведём индукцией по~построению формулы~$A$. Для атомарных формул корректная подстановка есть простая текстовая замена, поэтому $[(t\mid x)P(\ldots, x,\ldots)]\pi = [P(\ldots, t,\ldots)]\pi = P(\ldots, [t]\pi, \ldots ) = P(\ldots, [x](\pi + x \mapsto [t]\pi), \ldots ) = [P(\ldots, x,\ldots)](\pi + x \mapsto [t]\pi)$.

В случае формулы вида~$A \gamma B$ доказательство прямолинейно:\linebreak $[(t \mid x) (A\gamma B)]\pi = [(t \mid x)A\gamma (t \mid x)B]\pi = [(t \mid x)A] \pi \gamma [(t \mid x)B]\pi = [A](\pi + x \mapsto [t]\pi) \gamma [B](\pi + x \mapsto [t]\pi) = [A \gamma B](\pi + x \mapsto [t]\pi)$.

Случай~$\neg A$ аналогичен предыдущему.

Остаётся случай, когда формула начинается с~квантора. Пусть, например, формула имеет вид $\exists y A$, $x$~--- её параметр (отсюда~$x$ не~совпадает с~$y$). Тогда в~предположении корректной подстановки $t$ не~совпадает с~$y$. Тогда $[{(t \mid x)}\exists y A]\pi = [\exists y (t \mid x) A]\pi = \bigvee \limits_{m \in M} [(t \mid x) A](\pi + y \mapsto m)$.

Отсюда, по~предположению индукции, $[(t \mid x)\exists y A]\pi = \bigvee \limits_{m \in M} [A](\pi + y \mapsto m + x \mapsto [t](\pi + y \mapsto m) )$.

В силу корректности подстановки $t$ не~является~$y$, поэтому значение~$t$ не~изменится, если оценку $\pi + y \mapsto m$ заменить просто на~$\pi$. Далее, т.~к. $x$ не~совпадает с~$y$, два изменения оценки~$\pi$ можно поменять местами, откуда $[(t \mid x)\exists y A]\pi = \bigvee \limits_{m \in M} [A](\pi +x \mapsto [t]\pi + y \mapsto m )= \exists y[A](\pi +x \mapsto [t]\pi)$, что и~требовалось доказать. Для случая $\forall y A$ доказательство то~же, только дизъюнкцию необходимо заменить на~конъюнкцию.\endproof

\begin{theorem}\label{th:forallexistsax} Для произвольных формулы~$A$ и~терма~$t$, если подстановка ${(t\mid x) A}$ корректна, справедливо
\[\models \forall x A \imp (t\mid x) A,\] \[\models (t\mid x) A \imp \exists x A.\]
\end{theorem}

\beginproof Докажем первое утверждение. Если на~некоторой оценке $\forall x A$ ложна, то~вся импликация будет истинна. Если в~некоторой оценке $\forall x A$ истинна, то по~определению истинности формула~$A$ будет истинна на~всякой оценке, отличающейся~$\pi$ только лишь значением переменной~$x$. Значит, формула~$A$ будет истинна и~на~оценке $\pi +x \mapsto [t]\pi$, откуда по~лемме~\ref{lemma:subst} следует, что $[{(t\mid x)} A]\pi = \true$, и~вся импликация принимает значение~$\true$.\endproof

\begin{exercise}Докажите второе утверждение теоремы~\ref{th:forallexistsax}.
\end{exercise}
\begin{exercise}Приведите пример случая, когда некорректная подстановка даёт не~общезначимую формулу вида $(t\mid x) A \imp \exists x A$. (Ответ: $\forall y A(y, y) \imp \exists x \forall y A(x, y)$.)
\end{exercise}

Используя аналогичные рутинные рассуждения об~истинностных значениях формул на~оценках, можно доказать общезначимость и~в~других случаях. Но~гораздо экономнее (во~многих смыслах) пользоваться исчислением предикатов, чему и~будет посвящён следующий параграф.

\endinput
/////////////////////////////////////
\p Пусть предметной областью модели $\mathfrak M$ является множество неотрицательных целых чисел, а~двум предикатным символам~$S$ и~$P$ валентности 3 соответствуют условия~$x + y = z$ и~$xy = z$. Тогда при помощи формул можно выразить, например, следующие предикаты:

	\begin{tabular}{ll}

	$x = 0$: & $O(x) \rightleftharpoons \forall y S(x, y, x)$\\
	
	$x = 1$: & $U(x) \rightleftharpoons \forall y P(x, y, x)$\\
	
	$x$~--- чётно: & $E(x) \rightleftharpoons \exists y S(y, y, x)$\\

 $x$~--- нечётно: & $\neg \exists y S(y, y, x)$
	\end{tabular}
	
Знак $\rightleftharpoons$ здесь читается как <<равно по~определению>> и~с~его помощью мы~вводим в~рассмотрение новые предикатные символы, которые теперь можем подставлять вместо своих выражений в~более сложные формулы:

	$x = 2$: \[\exists z (U(z) \& S(z, z, x))\]
	
	(аналогично~--- для других чисел)
	
 $x$~--- простое число:
 \[P'(x) \rightleftharpoons \neg U(x) \& \forall y \forall z (P(y, z, x) \imp (U(y) \vee U(z)))\]

 $x = y$: \[x = y \rightleftharpoons \forall z \forall u S(x, z, u) \imp S(y, z, u)\]

 $x \leq y$: \[x \leq y \rightleftharpoons \exists z S(x, z, y)\]

 $x$ и~$y$~--- простые числа-близнецы: \[T(x, y) \rightleftharpoons \exists z (U(z) \& P'(x) \& P'(y) \& S(z, x, y))\]
\begin{exercise}\cite{Lavrov04}. Запишите формулы с~тремя свободными переменными~$x$, $y$ и~$z$, истинную в~рассматриваемой модели тогда и~только тогда, когда а\rp\ $z$~--- наименьшее общее кратное~$x$ и~$y$, б\rp\ $z$~--- наибольший общий делитель~$x$ и~$y$.
\end{exercise}


<<Простых чисел бесконечно много>>

\[\forall x \exists y (P'(y) \& (x \leq y))\]
\begin{exercise}\cite{Lavrov04}. Выразите в~рассматриваемой модели:
<<Простых чисел~--- конечное число>>, <<Для всякого числа существует строго меньшее число>>, <<Простых чисел-близнецов бесконечно много>>, <<Всякое чётное число, большее двух, есть сумма двух простых>>. Что можно сказать об~истинности этих высказываний?
\end{exercise}
	
