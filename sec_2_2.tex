\section{Операции над термами}\label{sec:thermoper}

\p[Термы вида $\{z \mid A\}$.] В~прошлом параграфе мы~на~основании аксиом ZF установили, что, например, для любого множества~$x$ и~произвольной формулы~$A$, не~содержащей~$u$ свободно, справедливо \[\exists! u \forall z (z \in u \lequals z \in x \&A).\]

Естественно было бы~в~дальнейшем ссылаться на~существующее и~единственное~$u$ как на~терм, образованный с~помощью формулы ${z \in x \& A}$. Обозначением для этого терма может служить, к~примеру, комбинация знаков $\{z \mid z \in x \& A\}$ или даже $\{ z \in x\mid A\}$ (читается <<множество~$z$ из~$x$, таких, что~$A$>>), где~$A$ следует заменить на~любую синтаксически корректную формулу с~параметром~$z$.

Мы, однако, обязаны действовать в~рамках языка, синтаксис которого определён на~с.~\pageref{praedformula} (этот язык называется \emph{языком первого порядка}), поскольку формальный логический вывод опирается на~этот синтаксис. Для удобства мы~уже расширяли язык первого порядка сокращающими обозначениями (такими, как~$\subseteq$,~$=$). При этом указывалось, как можно преобразовать формулу с~сокращающим обозначением в~формулу языка первого порядка. Так, сокращённая запись $a \subseteq b$ соответствует формуле $\forall x (x \in a \imp x \in b)$, или, ещё точнее, формуле $(\forall x (\in (x, a) \imp \in(x,b)))$ языка первого порядка. Чтобы обоснованно пользоваться логическими теоремами и~приёмами формального вывода, мы~и~в~дальнейшем не~должны потерять <<синтаксическую основу>> для всех используемых выражений.

Попытавшись ввести в~язык термы вида $\{z \mid z \in x \& A\}$ легко убедиться, что им~не~могут соответствовать термы языка первого порядка, где термами являются только константы или переменные. Термы, образуемые при помощи формул, являются принципиально новой синтаксической конструкцией. Но~мы тем не~менее можем корректно внедрить такие термы в~нашу систему, если покажем, как преобразовывать формулы с~их~участием в~формулы языка первого порядка.

Итак, расширим синтаксис языка первого порядка теории множеств новым определением: \emph{если~$A$~--- формула, не~содержащая переменную~$u$ в качестве параметра, и~$\mathrm{ZFC} \vdash \exists u \forall z (z \in u \lequals A)$, то~${\{z \mid A\}}$~--- терм}. Термы такого вида могут участвовать в~логических формулах наряду с~переменными и~константами, как определено на~с.~\pageref{praedformula}. Формулы расширенного языка могут быть переведены в~формулы языка первого порядка по~следующему алгоритму:

\begin{enumerate}
	\item все вхождения терма $\{z \mid A\}$ заменяются на~переменную~$u$,
	\item формула обрамляется конструкцией $\exists u (\forall z (z \in u \lequals A) \& \ldots)$.
\end{enumerate}

При этом, разумеется, имена переменных~$z$ и~$u$ должны быть выбраны таким образом, чтобы не~возникло нежелательных связываний кванторами.

Например, формуле $\{ z \mid A\} = \{ z \mid B\}$, где~$A$ и~$B$ не~содержат~$u$ и~$v$ свободно, соответствует в~языке первого порядка формула
\[\exists u \exists v \forall z ( (z\in u \lequals A) \& (z\in v \lequals B) \& u = v).\]

Итак, условием корректности терма ${\{z \mid A\}}$ мы~установили ${\mathrm{ZFC} \vdash \exists u \forall z ({z \in u} \lequals A)}$. Следуя терминологии Бурбаки~\citeburb{Bourbaki1}, будем говорить в~таком случае, что~$A$ есть формула, \emph{коллективизирующая по~$z$}. Иначе говоря, формула~$A$ со~свободной переменной~$z$ является коллективизирующей в~том и~только том случае, когда все~$z$, на~которых~$A$ истинна, образуют множество (как мы~уже знаем, в~теории ZFC это имеет место не~всегда).

Будем говорить, что формула расширенного языка теории множеств \emph{выводима}, если выводима соответствующая ей~формула языка первого порядка. Две формулы расширенного языка называются \emph{эквивалентными}, если эквивалентны соответствующие им~формулы языка первого порядка.

\p Интуитивно ясно, что формула $t\in \{z \mid A\}$ должна быть эквивалентна~$(t\mid z)A$. Действительно, некоторое~$t$ принадлежит множеству элементов, обладающих свойством~$A$, тогда и~только тогда, когда оно само обладает свойством~$A$. Обоснуем это формально, доказав общую теорему.

\begin{theorem}\label{th:substcollect} Если формула~$B'$ получена из~формулы~$B$ заменой подформул вида~$\xi \in u$ на~$(\xi \mid z)A$, то~\[\exists u (\forall z (z \in u \lequals A) \& B) \sim \exists u (\forall z (z \in u \lequals A) \& B').\]\end{theorem}

\beginproof Докажем индукцией по~построению формулы~$B$, что

\[
\begin{array}{l}
\vdash \forall z (z \in u \lequals A) \& B \imp B',\\
\vdash \forall z (z \in u \lequals A) \& B' \imp B,	
\end{array}
\]
из чего уже будет следовать требуемая эквивалентность.


\begin{enumerate}
	\item Если~$B$ имеет вид~$\xi \in u$, то
	
	\[\begin{array}{l}
	\forall z ((z \in u \lequals A) \& \xi \in u) \imp\\
	\quad \quad \imp (\xi \mid z)((z \in u \lequals A) \& \xi \in u) \sim\\
	\quad \quad \sim (\xi \in u \lequals (\xi \mid z)A) \& \xi \in u \sim\\
	\quad \quad \sim (\xi \mid z)A \& \xi \in u \imp\\
	\quad \quad \quad \imp (\xi \mid z)A,
	\end{array}
	\]
	\[\begin{array}{l}
	\forall z ((z \in u \lequals A) \& (\xi \mid z)A) \imp\\
	\quad \imp (\xi \in u \lequals (\xi \mid z)A) \& (\xi \mid z)A \sim\\
	\quad \quad \sim (\xi \mid z)A \& \xi \in u \imp\\
	\quad \quad \quad \imp \xi \in u.
	\end{array}
	\]
	
	\item Если~$B$ имеет вид~$\neg C$, то по~предположению индукции

\[
\begin{array}{l}
\vdash \forall z (z \in u \lequals A) \& C \imp C',\\
\vdash \forall z (z \in u \lequals A) \& C' \imp C.	
\end{array}
\]
	
	Но эти формулы эквивалентны соответственно формулам

\[
\begin{array}{l}
\forall z (z \in u \lequals A) \& \neg C' \imp \neg C,\\
\forall z (z \in u \lequals A) \& \neg C \imp \neg C'.	
\end{array}
\]

\item Если~$B$ имеет вид~$C \& D$, то по~предположению индукции
\[
\begin{array}{l}
\vdash \forall z (z \in u \lequals A) \& C \imp C',\\
\vdash \forall z (z \in u \lequals A) \& D \imp D',	
\end{array}
\]

откуда \[\vdash \forall z (z \in u \lequals A) \& C \& D \imp C'\& D'.\]

Аналогично доказывается смежное утверждение (достаточно поменять местами формулы со~штрихами и~без штрихов).

\item Если~$B$ имеет вид $\forall x C$, то
	\[
\begin{array}{l}
\vdash \forall z (z \in u \lequals A) \& \forall x C \imp \\
\quad \quad \imp \forall z (z \in u \lequals A) \& (\eta \mid x)C \imp (\eta \mid x)C',	
\end{array}
\]
где~$\eta$~--- некоторая переменная, не~используемая в~$C$ и~$A$.

Отсюда выводится $\forall z (z \in u \lequals A) \& \forall x C \imp \forall \eta (\eta \mid x)C'$, и в~силу выбора имени переменной~$\eta$ \[\forall z (z \in u \lequals A) \& \forall x C \imp \forall x C'.\]

Аналогично доказывается смежное утверждение (достаточно поменять местами~$C$ и~$C'$).
\end{enumerate}

Рассматривать остальные логические связки нет необходимости, т.~к. любая формула может быть сведена к~эквивалентной ей~со~связками~$\neg$, $\&$, $\forall$.\endproof

Теорема~\ref{th:substcollect} даёт возможность свободно заменять конструкции вида $t\in \{z \mid A\}$ в~формулах расширенного языка на~$(t\mid z)A$, что значительно упрощает вид (и, как следствие, вывод) этих формул. Особенно полезно это после раскрытия сокращающих символов \hbox{$\subseteq$ и $=$}, сводящего их~к~предикатным символам~$\in$.

\begin{exercise}Проверьте, что для доказательства выводимости $\{ z \mid A\} = \{ z \mid B\}$ достаточно установить, что~$A \sim B$.\end{exercise}

\p Введём теперь сокращающие обозначения для некоторых стандартных термов. Для самоконтроля читатель может проверить (на~основании аксиом ZF), что образующие их~формулы являются коллективизирующими, а~также самостоятельно обосновать те~свойства, доказательства которых не~будут приведены.

\begin{itemize}
	\item Пустое множество: $\varnothing\rightleftharpoons \{z \mid z \neq z\}$.

	Свойства: $\varnothing \subseteq x$ (пустое множество является подмножеством любого множества), $x \subseteq \varnothing \lequals x = \varnothing$.
	
	Действительно, раскрывая сокращения, получаем из~первой формулы эквивалентные ей~$\forall z (z \in \varnothing \imp z \in x)$ и~$\forall z (z \neq z \imp z \in x)$. Но~последнее общезначимо в~силу противоречия~$z = z$ и~$z \neq z$. Аналогичным образом доказываются и~остальные утверждения о~стандартных термах.
	%\item Стандартное бесконечное множество: $\omega \rightleftharpoons \{z \mid \}$ .
	\item Множество-степень (множество подмножеств~$x$): 	\[\mathfrak P (x) \rightleftharpoons \{z \mid z \subseteq x \}.\]
	
	Свойства: $\varnothing \in \mathfrak P (x)$, $x \in \mathfrak P (x)$.
	\item Множество-сумма: $\bigcup x \rightleftharpoons \{z \mid \exists v (z \in v \& v \in x)\}$.
	
	Свойства: $ x = \bigcup \mathfrak P (x) $, $x \subseteq \mathfrak P (\bigcup x)$.
	
	В первом случае доказательство сводится к~необходимости доказать $\exists v ( {z\in v }\& \forall t ({t \in v }\imp {t \in x})) \sim {z\in x}$, во~втором~--- к~$\vdash {z \in x }\imp ({u \in z} \imp \exists v ({v \in x} \& {u \in v}))$.
	
 \item Множество, определяемое по~аксиоме подстановки: \[\{y \mid \exists x (x \in t \& A\& \exists! y A) \}\] (где~$t$~--- терм, $A$~--- синтаксически корректная формула).

	\item Множество, заданное ограниченным выделением: \[\{z \in t \mid A \} \rightleftharpoons \{z \mid z \in t \& A \}\] (где~$t$~--- терм, $A$~--- синтаксически корректная формула). Его существование напрямую обусловлено схемой ограниченного выделения, доказанной в~теореме~\ref{th:addzfaxioms}.
	
	\item Множество-пересечение: $\bigcap x \rightleftharpoons \{z \in \bigcup x \mid \forall v (v \in x \imp z \in v)\}$.
	
	 \item Одноэлементное множество (синглетон): \[\{x\} \rightleftharpoons \{ z \in \mathfrak P(x) \mid z = x \}.\]
	
	 Свойства синглетона:
	
 \begin{enumerate}
 	\item $x \in \{x\}$,
 	\item $x \neq \{x\}$,
 	\item $u \in \{x\} \sim u = x$,
 	\item $x = y \sim \{x\} = \{y\}$,
 	\item $\bigcup \{x\} = x$.
 \end{enumerate}
	
\end{itemize}

\begin{exercise}Проверьте вышеперечисленные свойства.\end{exercise}

\begin{exercise}\label{ex:emptysetprop}Какие из~термов $\varnothing$, $\mathfrak P(\varnothing)$, $\bigcup \varnothing$, $\bigcap \varnothing$, $\{\varnothing\}$ равны между собой? (Ответ: $\varnothing = \bigcup \varnothing = \bigcap \varnothing$; $\mathfrak P(\varnothing) = \{\varnothing\} \neq \varnothing$.) \end{exercise}


\begin{itemize}

 \item Неупорядоченная пара: $\{x, y\} \rightleftharpoons \{z \mid z = x \vee z = y\}$.

 Проверка того, что $z = x \vee z = y$ является коллективизирующей формулой, представляет из~себя довольно рутинное упражнение по~формальному выводу, завершающее доказательство теоремы~\ref{th:addzfaxioms}. \label{pairproofdraft}За основу берётся схема подстановки, в~качестве <<ограничивающего>> множества~$v$ в~которую подставляется терм~$\mathfrak P \mathfrak P (\varnothing)$, а~в~качестве~$A$~--- формула $ ({x = \varnothing} \& {z = a}) \vee (x = \mathfrak \{\varnothing\} \& {z = b}) $. Последовательным упрощением формула приводится к~виду $\forall x \forall y \exists u \forall z ({z \in u} \lequals {z = x} \vee {z = y})$.

 Свойства неупорядоченной пары:

 \begin{enumerate}
 	\item $\{x, y\} = \{y, x\}$,
 	\item $x \in \{x, y\}$,
 	\item $\{x, y\} = \{u, v\} \sim (x = u \& y = v) \vee (x = v \& y = u)$,
 	\item $\{x, x\} = \{x\}$,
 	\item $\{x, y\} = \{u\} \sim x = u \& y = u$.
 \end{enumerate}

\end{itemize}


 Докажем третье свойство неупорядоченной пары.

 Справа налево. Как из~$x = u \& y = v$, так и~из~$x = v \& y = u$ в~силу свойств равенства выводится $\{x, y\} = \{u, v\}$. Следовательно, то~же~выводится из~дизъюнкции $(x = u \& y = v) \vee (x = v \& y = u)$.

 Слева направо. Из~$\{x, y\} = \{u, v\}$ следуют утверждения $x \in \{u, v\}$, $y \in \{u, v\}$, $u \in \{x, y\}$, $v \in \{x, y\}$, откуда выводится формула (обозначим её буквой~$F$) \[(x = u \vee x = v)\&(y = u \vee y = v)\&(x = u \vee y = u)\&(x = v \vee y = v).\]

 Нам необходимо доказать, что $\vdash F \imp G$, где через~$G$ обозначено $ ({x = u} \& {y = v}) \vee ({x = v} \& {y = u})$. Для этого достаточно проверить, что во~всех случаях, когда левая часть импликации истинна, правая также истинна. Рассуждаем следующим образом: пусть~$x = u$, тогда первый и~третий компоненты~$F$ становятся истинными. Для того, чтобы второй и~четвёртый компоненты стали истинными, остаются следующие два варианта: $y = v$ и~$y \neq v \& x = v \& y = u$. В~обоих этих случаях~$G$ будет истинно. Аналогичным образом проводятся рассуждения от~$x = v$, $y = u$ и~$y = v$.

\p Понятия синглетона~$\{x\}$ и~неупорядоченной пары~$\{x, y\}$ обобщаются на~произвольное конечное количество~$n$ элементов с~помощью следующего рекурсивного определения:
\[\{\vect xn\} \rightleftharpoons \bigcup \{\{\vect x{n-1}\}, \{x_n\}\},\]
откуда \[\{\vect xn\} = \{z \mid z = x_1 \vee \ldots \vee z = x_n\}.\]

Конструкция $\{\vect xn\}$ называется \emph{неупорядоченной~$n$-кой}, или \emph{$n$-элементным множеством, заданным перечислением}. С~её помощью на~основании аксиомы фундирования легко доказывается следующая теорема.

\begin{theorem}\label{th:regularity}
Не существует
\begin{itemize}
	\item множества~$x$, такого, что~$x \in x$,
	\item множеств~$x$, $y$, таких, что $x \in y \& y \in x$, и~вообще любого набора множеств~$\vect xn$, <<закольцованного>> по~отношению принадлежности условием $x_1 \in x_2 \& \ldots \& x_{n-1} \in x_n \& x_n \in x_1$.
\end{itemize}
\end{theorem}

\beginproof Предположим, что такие~$\vect xn$ существуют. В~этом случае существует и~множество $\{\vect xn\}$. Легко убедиться (см. с.~\pageref{theme:regularity}), что существование $\{\vect xn\}$ противоречит аксиоме фундирования~--- следовательно, исходное предположение неверно.\endproof

\begin{follow}Не существует множества всех множеств, т.~е. \[\neg \exists v \forall x\; x \in v.\]\end{follow}

\beginproof Если бы~такое множество существовало, то, очевидно, было бы~${v \in v}$.\endproof

Этот важный результат можно получить и~без использования аксиомы фундирования, см.~далее обсуждение теоремы~\ref{th:CantorPower}.

\begin{exercise}Докажите, что не~существует 1\rp~$x$ такого, что $\{x\} \in x$, 2\rp~$x$~такого, что $\{x\} \in \bigcup x$.
\end{exercise}

\p Введём операции объединения, пересечения, дополнения и~симметрической разности множеств, связанные с~двухместными логическими операциями.

\begin{itemize}
	\item Объединение множеств: $x \cup y \rightleftharpoons \bigcup \{x, y\}$.
\end{itemize}

Упрощая определение, имеем $x \cup y = \{ z \mid \exists v ( z \in v \& v\in \{t \mid t = x \vee t = y\} )\} = \{ z \mid \exists v ( z \in v \& (v = x \vee v = y) )\} = \{ z \mid \exists v ( z \in x \vee z \in y) \} = \{ z \mid ( z \in x \vee z \in y) \}$. Таким образом, объединение~$x$ и~$y$ представляет из~себя множество, каждый элемент которого содержится хотя бы~в~одном из~множеств~$x$,~$y$.

\begin{figure}[htbp]
	\centering
	\includegraphics{_pictures/union} \includegraphics{_pictures/intersection}
	\caption{Объединение и~пересечение двух множеств}
	\label{fig:unionintersect}
\end{figure}


Используя теперь объединение в~качестве ограничивающего множества~$t$ в~терме $\{z \in t \mid A \}$, мы~можем ввести следующие операции:
\begin{itemize}	
	 \item пересечение (множество из~элементов, принадлежащих одновременно~$x$ и~$y$) $x \cap y \rightleftharpoons \{z \in x \cup y \mid z \in x \& z \in y\}$,

 \item дополнение $x \setminus y \rightleftharpoons \{z \in x \cup y \mid z \in x \& z \notin y\}$,

 \item симметрическая разность $x \bigtriangleup y \rightleftharpoons \{z \in x \cup y \mid z \in x \oplus z \in y \}$.

\end{itemize}

\begin{figure}[htbp]
	\centering
	\includegraphics{_pictures/substraction} \includegraphics{_pictures/symdiff}
	\caption{Дополнение и~симметрическая разность двух множеств}
	\label{substsymdiff}
\end{figure}


Ограничивающее условие $z \in {x \cup y}$ во~всех этих трёх случаях можно убрать, т.~к. из~формул, стоящих справа от~вертикальной черты, следует $z \in x \vee z \in y$, что эквивалентно ограничивающему условию.

\p Если формула~$A$, построенная на~атомарных подформулах вида ${z \in x_1}$,\ldots ${z \in x_n}$, не~содержит кванторов, то~определить, является ли~она коллективизирующей, можно с~помощью простого критерия, а~термы вида $\{z \mid A\}$ составляют удобный для изучения класс.


\begin{theorem}\label{th:collcrit} Если даны множества~$\vect xn$, то~не~содержащая кванторов формула~$A$, построенная на~атомарных подформулах ${z \in x_1}$,\ldots ${z \in x_n}$, будет являться коллективизирующей по~$z$, если и~только если \[\vdash A \imp z \in x_1 \vee \ldots \vee z \in x_n.\]\end{theorem}

В терминах булевых функций данное требование означает, что функция, задаваемая формулой~$A$, должна принимать значение~$\false$ в~случае, когда все её элементарные подформулы принимают значение~$\false$. Такие булевы функции называются \emph{сохраняющими нуль}.

\beginproof В~одну сторону: из~условия следует, что \[A \sim z \in x_1 \vee \ldots \vee z \in x_n \& A.\] Это позволяет применить ограниченное выделение и~построить множество $\{z \in x_1 \cup \ldots \cup x_n \mid A\}$, равное $\{z \mid A\}$.

В обратную сторону: если условие не~выполняется, то~подстановка в~формулу~$A$ пустого множества вместо~$\vect xn$ должна давать тождественно истинную относительно~$z$ формулу (эквивалентную, например, $z = z$). Получающийся при этом терм $v = \{z \mid z = z\}$ подразумевает существование множества всех множеств, что противоречит следствию теоремы~\ref{th:regularity}.\endproof

Легко убедиться, что всего существует $2^{2^n - 1}$ не~равных между собой сохраняющих нуль булевых функций~$n$ аргументов и, как следствие, столько же~не~равных между собой термов рассматриваемого вида.

\begin{theorem}Любой терм вида $\{z \mid A\}$, где~$A$~--- бескванторная формула, построенная на~атомарных подформулах ${z \in x_1}$,\ldots ${z \in x_n}$, может быть представлен в~виде суперпозиции операций пересечения и~симметрической разности над множествами~$\vect xn$. \end{theorem}

\beginproof В~силу теоремы~\ref{th:collcrit} формула~$A$ задаёт сохраняющую нуль булеву функцию~$n$ аргументов. Представим формулу~$A$ в~виде эквивалентного ей~полинома Жегалкина (см. теорему~\ref{th:Zhegalkin}). Т.~к. $A$ сохраняет нуль, <<свободный член>> $\varepsilon_0$ соответствующего полинома должен быть равен~$\false$~--- иначе полином принимал бы~значение~$\true$ в~момент, когда все его аргументы равны~$\false$. Таким образом, $A$ может быть представлена в~виде суперпозиции одних только операций~$\&$ и~$\oplus$ над формулами ${z \in x_1}$,\ldots ${z \in x_n}$. Заменив в~этом представлении формулы ${z \in x_i}$ на~$x_i$, знаки~$\&$ на~$\cap$ и~$\oplus$ на~$\bigtriangleup$, получим искомое представление для терма $\{z \mid A\}$.\endproof

Таким образом, по~аналогии с~базисами логических операций, пара операций~$\cap$ и~$\bigtriangleup$ образует базис в~классе термов, построенных с~помощью бескванторных формул от~${z \in x_1}$,\ldots ${z \in x_n}$. Естественно, мы~можем выбрать в~качестве базисного и~другой набор операций, коль скоро из~него выражаются пересечение и~симметрическая разность. Чаще всего за~основу берут набор из~трёх операций~$\cup$, $\cap$ и~$\setminus$, имея в~виду, что $x \bigtriangleup y = (x\cup y)\setminus(x\cap y)$ (проверьте).

Некоторые свойства операций~$\cup$, $\cap$ и~$\setminus$:

\quad$x\cap x= x$,

\quad$x\cup x= x$,

\quad$x\setminus x= \varnothing$,

\quad$x\cap y= y\cap x$,

\quad$x\cup y= y\cup x$ (коммутативность),

\quad$(x\cap y)\cap z= x\cap (y\cap z)$,

\quad$(x\cup y)\cup z= x\cup (y\cup z)$ (ассоциативность),

\quad$x\cap (y\cup z)= (x\cap y)\cup (x\cap z)$,

\quad$x\cup (y\cap z)= (x\cup y)\cap (x\cup z)$,

\quad$(x\cup y)\setminus z = (x\setminus z)\cup (y\setminus z)$ (дистрибутивность),

\quad$z\setminus (x\cap y)= (z\setminus x)\cup (z\setminus y)$,

\quad$z\setminus (x\cup y)= (z\setminus x)\cap (z\setminus y)$,

\quad$z\setminus (y\setminus x)= (x\cap z)\cup (z\setminus y)$,

\quad$(y\setminus x)\cap z= (y\cap z)\setminus x= y\cap (z\setminus x)$,

\quad$(y\setminus x)\cup z= (y\cup z)\setminus (x\setminus z)$,\pagebreak[3]

\quad$x\cap \varnothing= \varnothing, \quad x\cup \varnothing= x$,

\quad$\varnothing\setminus x= \varnothing,\quad x\setminus \varnothing= x$.

Чтобы доказать любое из~этих равенств, нужно, как обычно, проверить эквивалентность образующих соответствующие термы формул. Т.~к. эти формулы бескванторные, задача упрощается, поскольку для изучения свойств бескванторных формул можно применять таблицы Куайна. Однако б\'ольшую наглядность при решении подобных задач дают широко известные диаграммы Эйлера--Венна, на~которых множества изображаются в~виде пересекающихся замкнутых фигур.

\begin{figure}[htbp]
	\centering
		\includegraphics{_pictures/Euler}
	\caption{Диаграмма Эйлера, терм $(y\setminus x)\cap z$}
	\label{fig:Euler}
\end{figure}


Диаграммы Эйлера--Венна для двух и~трёх множеств показаны на~рис.~\ref{fig:unionintersect}--\ref{fig:Euler}. Диаграмма для~$n$ множеств содержит~$2^n - 1$ областей пересечения. Закрашивая штриховкой выборки из~этих областей, можно проиллюстрировать любой из~$2^{2^n - 1}$ термов, образуемых бескванторными формулами над ${z \in x_1}$,\ldots ${z \in x_n}$. На~рис.~\ref{fig:Euler} штриховкой показан терм $(y\setminus x)\cap z$, равный $(y\cap z)\setminus x$ и~$y\cap (z\setminus x)$.

В XX в. Энтони Эдвардсом был предложен изящный способ построения диаграмм Эйлера--Венна для произвольного числа множеств. Диаграммы Эдвардса для случая двух, трёх, четырёх и~пяти множеств показаны на~рис.~\ref{fig:Edwards}.

\begin{figure}[htb]
	\centering
		\includegraphics{_pictures/Edwards2}\quad \includegraphics{_pictures/Edwards3}
		\vskip6pt
		\includegraphics{_pictures/Edwards4}\quad \includegraphics{_pictures/Edwards5}
	\caption {Диаграммы Эдвардса}
	\label{fig:Edwards}
\end{figure}

\begin{exercise}Докажите, что любая формула, построенная над множествами $x, x_1, \ldots x_n$ с~помощью операций~$\cup$, $\cap$, $\bigtriangleup$ и~$\setminus$, может быть представлена в~виде \[a \bigtriangleup (e_1 \cap x) \bigtriangleup (e_2 \cap b \cap x),\] где выражения для~$a$ и~$b$ не~содержат~$x$, а~$e_1$ и~$e_2$ равны либо~$x$, либо $\varnothing$.
\end{exercise}

\begin{exercise}\cite{Lavrov04}. Докажите, что
	\[\begin{array}{l}
(x_1 \cap \ldots \cap x_n) \bigtriangleup (y_1 \cap \ldots \cap y_n) \subseteq (x_1 \bigtriangleup y_1) \cup \ldots \cup (x_n \bigtriangleup y_n),\\	
(x_1 \cup \ldots \cup x_n) \bigtriangleup (y_1 \cup \ldots \cup y_n) \subseteq (x_1 \bigtriangleup y_1) \cup \ldots \cup (x_n \bigtriangleup y_n).
\end{array}
\]
Указание: воспользуйтесь индукцией по~числу множеств. Для доказательства базы индукции можно воспользоваться диаграммами для четырёх множеств~$x_1$,~$x_2$, $y_1$,~$y_2$ (см. рис.~\ref{fig:4s1} и~\ref{fig:4s3}).

\begin{figure}[htbp]
	\centering
		\includegraphics{_pictures/4s1}\quad \includegraphics{_pictures/4s2}
	
	\caption {$(x_1\cap x_2)\bigtriangleup(y_1\cap y_2)$ и~$(x_1\cup x_2)\bigtriangleup(y_1\cup y_2)$}\label{fig:4s1}
\end{figure}
\begin{figure}[htbp]
	\centering
		\includegraphics{_pictures/4s3}
	
	\caption {$(x_1 \bigtriangleup y_1)\cup(x_2 \bigtriangleup y_2)$}\label{fig:4s3}
\end{figure}
\end{exercise}

\begin{exercise}\label{ex:progr}Докажите, что в~теории ZF $x \cup \{x\} = y \cup \{y\} \sim x = y$.

Решение. Утверждение $x = y \imp x \cup \{x\} = y \cup \{y\}$ следует из~свойств равенства. Докажем обратное утверждение от~противного: пусть $x\cup\{x\} = y\cup\{y\}$, но при этом $x \neq y$. Без ограничения общности можем считать, что существует такой $t$, что $t \in x$ и~$t \notin y$. Отсюда $t \in x \imp t \in x \cup \{x\} \imp t \in y \cup \{y\} \imp t \in y \vee t = y$. Из этого и~$t \notin y$ следует, что $t = y$ и~$y\in x$. Но с~другой стороны,  $x \in x\cup\{x\} \imp x \in y\cup\{y\} \imp x \in y \vee x = y$. В~первом случае имеем $y \in x \in y$, во втором~--- $y \in y$, и~оба варианта противоречат аксиоме фундирования (см. теорему~\ref{th:regularity}), значит, $x \neq y$ не имеет места.\end{exercise}


\p Легко убедиться, что $\{x, y\} = \{y, x\}$, т.~е. в~неупорядоченной паре порядок следования элементов не~имеет значения. Между тем для дальнейшего нам потребуется объединять пары множеств в~конструкцию, в~которой различаются \emph{первый} и~\emph{второй} компоненты. Иначе говоря, нужен способ построения из~$x$ и~$y$ такой конструкции~$(x, y)$, что \[(x, y) = (u, v) \sim (x = u) \& (y = v).\]

При построении теории множеств можно считать упорядоченную пару таким же~основным, невыводимым понятием, как и~множество, а~указанное свойство~--- аксиомой упорядоченной пары. Но~можно и~избежать этого, если воспользоваться одним из~приёмов введения упорядоченной пары с~помощью множеств:

\begin{itemize}
 \item Упорядоченная пара (по~Курат\'{о}вскому\indKuratowski): \[(x, y) \rightleftharpoons \{\{x\}, \{x, y\}\}.\]
\end{itemize}

Основное свойство упорядоченной пары: \[(x, y) = (u, v) \lequals (x = u) \& (y = v).\]

Справа налево это утверждение следует из~свойств равенства.

Слева направо: пусть $\{\{x\}, \{x, y\}\} = \{\{u\}, \{u, v\}\}$. В~силу доказанного выше третьего свойства неупорядоченной пары \[(\{x\} = \{u\} \& \{x, y\} = \{u, v\})\vee (\{x\} = \{u, v\} \& \{x, y\} = \{u\}).\]

Докажем разбором случаев, что из~этого следует то, что требуется доказать.

Первый случай: $\{x\} = \{u\} \& \{x, y\} = \{u, v\}$. Из~первой компоненты конъюнкции следует, что~$x = u$. Из~второй следует $(x = u \& y = v) \vee (x = v \& y = u)$, и~нам требуется вывести от~этого импликацию к~$y = v$. Вновь используем разбор случаев: первая компонента этой дизъюнкции уже содержит то, что нам требуется доказать, конъюнкция правой части с~$x = u$ даёт \[x = v \& y = u \& x = u \imp u = v \& y = v.\]

Второй случай: $\{x\} = \{u, v\} \& \{x, y\} = \{u\}$. В~силу доказанного выше четвёртого свойства неупорядоченной пары следует, что $x = u \& x = v \& y = u$, т.~е. все переменные равны между собой, и~отсюда же~--- $(x = u) \& (y = v)$.
\begin{exercise}\cite{VereShen1}. Докажите аналогичное утверждение для упорядоченной пары по~Винеру\indWiener: $(x, y) \rightleftharpoons \{\{\varnothing, \{x\}\}, \{\{y\}\}\}$.
\end{exercise}

\begin{exercise}Докажите, что понятие упорядоченной пары можно ввести и~так: $(x, y) \rightleftharpoons \{x, \{x, y\}\}$, но~в~этом случае для доказательства основного свойства надо ссылаться на~аксиому фундирования.\end{exercise}

Понятие упорядоченной пары обобщается на~произвольное конечное количество~$n$ элементов с~помощью следующего рекурсивного определения: \[(\vect xn) \rightleftharpoons ((x_1, \ldots x_{n-1}), x_n).\]

Конструкция~$(\vect xn)$ называется \emph{упорядоченной~$n$-кой}, или \emph{кортежем}, а~$\vect xn$~--- \emph{компонентами} кортежа~$(\vect xn)$.


\p Множество всех возможных упорядоченных пар~$(u, v)$, где ${u \in x}$, а~$v \in y$, называется \emph{прямым}, или \emph{декартовым произведением множеств~$x$~и~$y$} и~обозначается~$x \times y$. Пользуясь определением упорядоченной пары по~Куратовскому, мы~можем формально записать, что \[x \times y \rightleftharpoons \{ z \in \parts \parts (x \cup y)\mid \exists u \exists v (u \in x \& v \in y \& z = (u, v))\}.\]

Т. к. $\exists u \exists v (u \in x \& v \in y \& z = (u, v)) \imp z \in \parts \parts (x \cup y)$, ограничивающее условие $z \in \parts \parts (x \cup y)$ можно убрать из~определения.

Пример декартова произведения: если~$a$, $b$, $c$, $d$, $e$~--- различные между собой элементы, то~$\{a, b, c\} \times \{d, e\} = \{(a, d), (a, e), (b, d), (b, e), (c, d), (c, e)\}$.

Декартову произведению множеств не~свойственны коммутативность и~ассоциативность (в~силу того, что эти свойства отсутствуют у~упорядоченных пар, составляющих декартово произведение), но~свойственна дистрибутивность относительно операций~$\cup$, $\cap$, $\setminus$ и~$\bigtriangleup$. Например,

\[
\begin{array}{l}
(x \cup y)\times z = (x \times z) \cup (y \times z),\\
x \times (y \cup z) = (x \times y) \cup (x \times z).\\
\end{array}
\]

Докажем первое. $t \in (x \cup y)\times z \sim \exists u \exists v (u \in (x\cup y) \& v \in z \& t = (u, v))\sim \exists u \exists v (({u \in x}\vee {u \in y}) \& {v \in z} \& t = (u, v))\sim \exists u \exists v (({u \in x} \& {v \in z} \& t = (u, v))\vee ({u \in y}\& {v \in z} \& {t = (u, v)})) \sim t \in (x \times z) \cup (y \times z)$.

Аналогичные свойства дистрибутивности доказываются для операций~$\cap$, $\setminus$ и~$\bigtriangleup$.

\begin{exercise}\cite{Lavrov04}. Докажите, что
\[\begin{array}{l}
x \times \varnothing = \varnothing \times x = \varnothing,\\
x \subseteq u \& y \subseteq v \sim x \times y \subseteq u \times v,\\
x = u \& y = v \sim x \times y = u \times v,\\
(x\cap y) \times (u \cap v) = (x \times u)\cap(y \times v).\\
\end{array}
\]
\end{exercise}

\p Рассмотрим операции, являющиеся в~некотором смысле обратными к~операциям образования упорядоченной пары и~декартова произведения. Если в~качестве определения упорядоченной пары используется упорядоченная пара по~Куратовскому, то

\begin{itemize}
	\item первая и~вторая малые проекции:
\[
\begin{array}{l}
\pr_1(x) \rightleftharpoons \bigcup \{ u \in \bigcup x \mid \exists v \; (u, v) = x\},\\
\pr_2(x) \rightleftharpoons \bigcup \{ v \in \bigcup x \mid \exists u \; (u, v) = x\},\\
\end{array}
\]
	\item первая и~вторая большие проекции:
\[
\begin{array}{l}
\Pr_1(x) \rightleftharpoons \{u \in \bigcup \bigcup x \mid \exists v\ (u, v) \in x\},\\
\Pr_2(x) \rightleftharpoons \{v \in \bigcup \bigcup x \mid \exists u\ (u, v) \in x\}.\\
\end{array}
\]
	\end{itemize}
		
	Основными свойствами проекций, как нетрудно проверить, являются
\[
\begin{array}{l}
\pr_1((u, v)) = u, \quad \pr_2((u, v)) = v,\\
\Pr_1(x \times y) = x, \quad \Pr_2(x \times y) = y,\\
r \subseteq x \times y \imp \Pr_1(r) \subseteq x,\\
r \subseteq x \times y \imp \Pr_2(r) \subseteq y.
\end{array}
\]

\begin{figure}[htbp]
	\centering
		\includegraphics{_pictures/proj}
	\caption{Большая и~малая проекции}
	\label{fig:projections}
\end{figure}	
Для понятий большой и~малой проекции имеется наглядная геометрическая интерпретация. Пусть~$x$~--- множество всех точек оси абсцисс, $y$~--- множество всех точек оси ординат. Тогда декартово произведение~$x\times y$ является всей координатной плоскостью, элемент $u \in x\times y$ (который есть упорядоченная пара)~--- точкой на~плоскости, а~множество $v \subseteq x\times y$ (множество пар)~--- фигурой на~этой плоскости. Первая малая проекция является операцией, ставящей в~соответствие точке её абсциссу, а~первая большая проекция ставит в~соответствие области множество абсцисс точек, составляющих область (см. рис.~\ref{fig:projections}).
